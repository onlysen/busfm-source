$(function(){function i(a){$.get("/ajax/content",{id:$("#hidchannel").val(),t:(new Date).getMilliseconds()},function(b){k=false;e=eval(b);b=$("#hidPriPlay");if(b.length>0){var c=[];c.push(b.attr("sid"));c.push($(".hpp_title",b).text());c.push($(".hpp_url",b).text());c.push($(".hpp_artist",b).text());c.push($(".hpp_album",b).text());c.push($(".hpp_thumb",b).text());e.unshift(c);b.remove()}b=$("#hidchannel").val();$("#channel-list li[cid="+b+"]").addClass("cur");if(e.length>1)l?g(d):h(d);typeof a!=
"undefined"&&a.hide()})}function h(a){d=a;try{$("#jp").jPlayer("setMedia",{mp3:e[d][2]})}catch(b){alert(b.message)}var c=$("#SongInfo ul li"),j=e[d][1];a=e[d][0];c.eq(0).text("\u66f2\u76ee: "+j);c.eq(1).text("\u6b4c\u624b: "+e[d][3]);c.eq(2).text("\u4e13\u8f91: "+e[d][4]);$("#fav").data({cursongid:a});document.title=j+" - \u5df4\u58eb\u7535\u53f0";c=e[d][5];var m=$("#coverimg"),s=new Image;$("img",m).addClass("loading").attr("src","image/loading.gif");$(s).load(function(){var n=$(this).attr("title",
j).hide();m.find("img").remove().end().append(this);n.fadeIn(1E3)}).error(function(){$("img",m).attr({src:"image/default.gif",title:j}).removeClass("loading")}).attr({src:c});$("#clipbord").css({bottom:-30});var p=$("#fav span").removeClass("star");if(getCookie("member_id")!="")$("#hidchannel").val()=="99"?p.addClass("star"):$.get("/ajax/ifsc?id="+a+"&t="+(new Date).getMilliseconds(),function(n){n=="1"&&p.addClass("star")})}function g(a){h(a);try{$("#jp").jPlayer("play")}catch(b){alert(b.message)}}
function o(){var a;if(d+1<e.length){a=d+1;g(a)}else{k=l=true;d=0;i()}}function q(){$("#jplayer_play").is(":hidden")?$("#jplayer_pause").trigger("click"):$("#jplayer_play").trigger("click")}function r(a){if(a){f+=0.1;if(f>1)f=1}else{f-=0.1;if(f<0)f=0}$("#jp").jPlayer("volume",f)}var d=0,e,f=0.8,l=true,k=true;$("#jp").jPlayer({ready:function(){i()},ended:function(){o()},timeupdate:function(a){a=Number(a.jPlayer.status.seekPercent);$("#jplayer_load_bar").text(round(a,2)+"%")},error:function(a){a.jPlayer.error.type==
$.jPlayer.error.URL&&o()},preload:"auto",solution:"html,flash",supplied:"mp3",warningAlerts:true,errorAlerts:false,cssSelector:{play:"#jplayer_play",pause:"#jplayer_pause",stop:"#jplayer_stop",currentTime:"#pt",duration:"#tt",volumeBar:"#jplayer_vbar",volumeBarValue:"#vamount"},cssSelectorAncestor:"",swfPath:"js/v2"});$("#volumeInfo").click(function(){return false});$("#jplayer_vbar,#vamount").click(function(a){var b=$(this).offset();f=(a.clientX-b.left)/$("#jplayer_vbar").width();if(f>0){a=$("#jplayer_vmin span");
a.is(".mute")&&a.removeClass("mute")}});$("#jplayer_vmin").click(function(){var a=$("span",this);if(a.is(".mute")){$("#jp").jPlayer("volume",f);a.removeClass("mute")}else{$("#jp").jPlayer("volume",0);a.addClass("mute")}return false});$("#jplayer_previous").click(function(){g(d-1>=0?d-1:e.length-1);return false});$("#jplayer_next").click(function(){if(!k){o();return false}});$("#channel-list li").click(function(){var a=$(this);if(!a.is(".cur")){var b=a.attr("cid");if(b=="99")if(getCookie("member_id")==
""){$("#user_ico").trigger("click");return}$("#hidchannel").val(b);$(".cur").removeClass("cur");a.addClass("cur");a=$(".sidewidget").show();l=true;i(a)}});$("*").keydown(function(a){a.stopPropagation();var b=$(this),c=a.which;if(!((b.is(":input")||b.is("textarea"))&&c==32)){if(c==39)c=78;if(a.altKey)switch(c){case 80:q();break;case 76:$("#fav").trigger("click");break;case 83:a=$("#clipbord").css("bottom").replace(/[^-^\d]*/gi,"");a=Number(a);a<0?$("#recom").trigger("click"):$("#clipbord .n-close").trigger("click");
break;case 78:$("#jplayer_next").trigger("click");break;case 38:r(true);break;case 40:r();break;case 77:$("#jplayer_vmin").trigger("click")}else c==32&&q()}})});function round(i,h){for(var g=1;h>0;){g*=10;h--}for(;h<0;){g/=10;h++}return Math.round(i*g)/g};